<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="Boruta é um algoritmo de feature selection desenvolvido em 2010 e desenhado para fazer uma seleção automática de features em um banco de dados."><meta property="og:title" content><meta property="og:description" content="Boruta é um algoritmo de feature selection desenvolvido em 2010 e desenhado para fazer uma seleção automática de features em um banco de dados."><meta property="og:type" content="website"><meta property="og:image" content="https://henriqueld.github.io/quartz/icon.png"><meta property="og:url" content="https://henriqueld.github.io/quartz/machinelearning/Boruta/"><meta property="og:width" content="200"><meta property="og:height" content="200"><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="Boruta é um algoritmo de feature selection desenvolvido em 2010 e desenhado para fazer uma seleção automática de features em um banco de dados."><meta name=twitter:image content="https://henriqueld.github.io/quartz/icon.png"><title>Guia de estudos de Machine Learning</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://henriqueld.github.io/quartz//icon.png><link href=https://henriqueld.github.io/quartz/styles.19109a40042e9f0e72e952fda4442a34.min.css rel=stylesheet><link href=https://henriqueld.github.io/quartz/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://henriqueld.github.io/quartz/js/darkmode.ea03503ca359b66bfbe4d5557fb73029.min.js></script>
<script src=https://henriqueld.github.io/quartz/js/util.00639692264b21bc3ee219733d38a8be.min.js></script>
<link rel=preload href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css as=style onload='this.onload=null,this.rel="stylesheet"' integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/@floating-ui/core@1.2.1></script>
<script src=https://cdn.jsdelivr.net/npm/@floating-ui/dom@1.2.1></script>
<script defer src=https://henriqueld.github.io/quartz/js/popover.aa9bc99c7c38d3ae9538f218f1416adb.min.js></script>
<script defer src=https://henriqueld.github.io/quartz/js/code-title.ce4a43f09239a9efb48fee342e8ef2df.min.js></script>
<script defer src=https://henriqueld.github.io/quartz/js/clipboard.2913da76d3cb21c5deaa4bae7da38c9f.min.js></script>
<script defer src=https://henriqueld.github.io/quartz/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const SEARCH_ENABLED=!1,LATEX_ENABLED=!0,PRODUCTION=!0,BASE_URL="https://henriqueld.github.io/quartz/",fetchData=Promise.all([fetch("https://henriqueld.github.io/quartz/indices/linkIndex.dfdd544ef1608f24180de30edea2d389.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://henriqueld.github.io/quartz/indices/contentIndex.bc30cfb77a124cd5aeb65a611b733edc.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://henriqueld.github.io/quartz",!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://henriqueld.github.io/quartz",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}var i=document.getElementsByClassName("mermaid");i.length>0&&import("https://unpkg.com/mermaid@9/dist/mermaid.esm.min.mjs").then(e=>{e.default.init()});function a(n){const e=n.target,t=e.className.split(" "),s=t.includes("broken"),o=t.includes("internal-link");plausible("Link Click",{props:{href:e.href,broken:s,internal:o,graph:!1}})}const r=document.querySelectorAll("a");for(link of r)link.className.includes("root-title")&&link.addEventListener("click",a,{once:!0})},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'’':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/henriqueld.github.io\/quartz\/js\/router.d6fe6bd821db9ea97f9aeefae814d8e7.min.js"
    attachSPARouting(init, render)
  </script><script defer data-domain=henriqueld.github.io/quartz src=https://plausible.io/js/script.js></script>
<script>window.plausible=window.plausible||function(){(window.plausible.q=window.plausible.q||[]).push(arguments)}</script></head><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://henriqueld.github.io/quartz/js/full-text-search.e6e2e0c213187ca0c703d6e2c7a77fcd.min.js></script><div class=singlePage><header><h1 id=page-title><a class=root-title href=https://henriqueld.github.io/quartz/>Guia de estudos de Machine Learning</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><p class=meta>Last updated
Aug 7, 2023
<a href=https://github.com/henriqueLD/quartz/tree/hugo/content/machinelearning/Boruta.md rel=noopener>Edit Source</a></p><ul class=tags></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#exemplo>Exemplo</a><ol><li><a href=#shadow-features>Shadow Features</a></li><li><a href=#avaliando-as-features-importances>Avaliando as features importances</a></li><li><a href=#distribuição-binomial>Distribuição Binomial</a></li><li><a href=#conclusão>Conclusão</a></li></ol></li></ol></nav></details></aside><p>Boruta é um algoritmo de feature selection desenvolvido em 2010 e desenhado para fazer uma seleção automática de features em um banco de dados. Surgiu originalmente como um módulo no R, porém foi feita uma implantação em Python com mais flexibilidade nos parâmetros.</p><p>Resumidamente, o Boruta permuta as features existentes nos bancos de dados (chamadas de <strong>shadow features</strong>) e compara sua importância com as features originais, em teoria <strong>qualquer feature significante</strong> para a solução do problema tende a ser <strong>mais importante do que a melhor shadow feature</strong>.</p><a href=#exemplo><h2 id=exemplo><span class=hanchor arialabel=Anchor># </span>Exemplo</h2></a><p>A seguir vamos exemplificar o funcionamento do método com um dataset simples, onde queremos <strong>inferir a renda</strong> de uma pessoa a partir da sua <strong>idade</strong>, <strong>altura</strong> e <strong>peso</strong>:</p><p><a class="internal-link broken">center</a></p><a href=#shadow-features><h3 id=shadow-features><span class=hanchor arialabel=Anchor># </span>Shadow Features</h3></a><p>No Boruta, as features não competem entre si, em vez disso elas são comparadas com uma versão randomizada delas mesmas, as denominadas <strong>shadow features</strong>. No nosso exemplo, será criada a coluna <strong>shadow_age</strong> que representa a permutação das observações de <strong>age</strong>, e analogamente <strong>shadow_height</strong> e <strong>shadow_weight</strong>.</p><p>Essas shadow features são agrupadas ao dataset original de features, obtendo agora um novo dataframe <em>&ldquo;X_Boruta&rdquo;</em>:
<a class="internal-link broken">center</a></p><p>Próximo passo é ajustar uma <a href=/quartz/machinelearning/Random-Forest-Classifica%C3%A7%C3%A3o rel=noopener class=internal-link data-src=/quartz/machinelearning/Random-Forest-Classifica%C3%A7%C3%A3o>Random Forest</a> utilizando <strong>X_Boruta</strong> para predizer <strong>income</strong>.</p><a href=#avaliando-as-features-importances><h3 id=avaliando-as-features-importances><span class=hanchor arialabel=Anchor># </span>Avaliando as features importances</h3></a><p>Agora que temos as shadow features e o modelo ajustado, vamos calcular as features importances de cada uma das features no dataset <em>X_Boruta</em> e <strong>identificar a maior feature importance obtida entre as shadow features</strong>.</p><p>Quando a importance de uma feature é maior do que esse threshold, consideramos um &ldquo;acerto&rdquo;. A ideia é que <strong>uma feature só é importante se for capaz de explicar melhor a target do que a melhor shadow feature</strong>.
<a class="internal-link broken">center</a>
Aqui o threshold é 14%, logo apenas 2 features atingiram a expectativa e foram consideradas úteis, <strong>age</strong> e <strong>height</strong>, enquanto <strong>weight</strong> não performou bem. Aparentemente deveríamos desconsiderar a última feature, porém <mark style=background:#adccffa6>devemos acreditar em apenas uma estimativa?</mark></p><a href=#distribuição-binomial><h3 id=distribuição-binomial><span class=hanchor arialabel=Anchor># </span>Distribuição Binomial</h3></a><p>Como em outros diversos métodos em machine learning, a iteração é uma ferramenta útil e que nos trás muitos benefícios, principalmente para validarmos a feature importance utilizando Boruta.</p><p>Se realizarmos o processo de ajuste de modelo e contagem de &ldquo;acertos&rdquo; em 20 iterações, obtemos os seguintes resultados:
<a class="internal-link broken">center</a></p><p>Agora como podemos definir um <strong>critério de decisão?</strong> Vamos partir do pressuposto que não temos a menor ideia se uma feature é significante ou não, qual a probabilidade que devemos mantê-la? <strong>O nível máximo de incerteza é 50%, como jogar uma moeda para tomar essa decisão</strong>.</p><p>Como cada iteração nos retorna um resultado binário (acerto ou não), <mark style=background:#adccffa6>uma série de n iterações segue uma distribuição binomial</mark> e vamos utilizar essa distribuição para tomar a decisão:</p><p><a class="internal-link broken">center</a></p><p>Aqui não teremos um critério 100% objetivo para manter ou remover a feature, em vez disso usaremos áreas de aceitação:
<strong>Área de recusa</strong>: representada de <mark style=background:#ff5582a6>vermelho</mark>, se a distribuição dos acertos de uma feature caírem aqui, consideramos ela não significante e removemos do dataset.
<strong>Área de dúvida</strong>: representada de <mark style=background:#adccffa6>azul</mark> é a área onde o método é indeciso se devemos manter ou remover a variável, e portanto, <em>temos a liberdade para tomar a decisão</em>.
<strong>Área de aceitação:</strong> representada de <mark style=background:#bbfabba6>verde</mark>, área onde caem as features consideradas significantemente preditivas para o problema em questão, e devem sempre ser mantidas.</p><p>As regiões são definidas selecionando as duas caudas mais extremas da distribuição binomial, onde cada cauda corresponde a aproximadamente 0.5% da distribuição.</p><p>Em resumo, após 20 iterações nós podemos tomar decisões com base em estatísticas bem definidas:</p><ol><li>Para o problema de inferir o <strong>income</strong>, devemos manter <strong>age</strong> como variável preditiva e remover a variável de <strong>weight</strong></li><li>O método de Boruta foi indeciso com relação a variável <strong>height</strong> e a escolha fica na nossa mão se devemos ou não manter (se não houver extrema necessidade de redução de custo operacional, é recomendável manter as variáveis na zona de dúvida)</li></ol><p>Após a definição das variáveis importante, <mark style=background:#ff5582a6>não devemos esquecer de desconsiderar completamente as shadow features para o modelo final</mark>.</p><a href=#conclusão><h3 id=conclusão><span class=hanchor arialabel=Anchor># </span>Conclusão</h3></a><p>Boruta é um método que realiza feature selection de maneira estatisticamente robusta, removendo o processo subjetivo de definir o threshold de corte que é necessário em várias outras técnicas de feature selection.</p></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li>No backlinks found</li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://henriqueld.github.io/quartz/js/graph.6579af7b10c818dbd2ca038702db0224.js></script></div></div><div id=contact_buttons><footer><p>Made by Henrique Limão Dias using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, © 2023</p><ul><li><a href=https://henriqueld.github.io/quartz/>Home</a></li><li><a href=https://github.com/henriqueld>GitHub</a></li></ul></footer></div></div></body></html>